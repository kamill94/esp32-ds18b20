<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>esp32-ds18b20: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">esp32-ds18b20
   </div>
   <div id="projectbrief">ESP32-compatible C library for Maxim Integrated DS18B20 Programmable Resolution 1-Wire Digital Thermometer.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">esp32-ds18b20 Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Introduction</h2>
<p>This is a ESP32-compatible C component for the Maxim Integrated DS18B20 Programmable Resolution 1-Wire Digital Thermometer device.</p>
<p>It supports multiple devices on the same 1-Wire bus.</p>
<p>It is written and tested for v2.1, v3.0-3.3 and v4.1-beta1 of the <a href="https://github.com/espressif/esp-idf">ESP-IDF</a> environment, using the xtensa-esp32-elf toolchain (gcc version 5.2.0).</p>
<h2>Dependencies</h2>
<p>Requires <a href="https://github.com/DavidAntliff/esp32-owb">esp32-owb</a>.</p>
<h2>Example</h2>
<p>See <a href="https://github.com/DavidAntliff/esp32-ds18b20-example">esp32-ds18b20-example</a> for an example that supports single and multiple devices on a single bus.</p>
<h2>Features</h2>
<p>In cooperation with the underlying esp32-owb component, this component includes:</p>
<ul>
<li>External power supply mode.</li>
<li>Parasitic power mode (VDD and GND connected) - see notes below.</li>
<li>Static (stack-based) or dynamic (malloc-based) memory model.</li>
<li>No globals - support any number of DS18B20 devices on any number of 1-Wire buses simultaneously.</li>
<li>1-Wire device detection and validation, including search for multiple devices on a single bus.</li>
<li>Addressing optimisation for a single (solo) device on a bus.</li>
<li>CRC checks on temperature data.</li>
<li>Programmable temperature measurement resolution (9, 10, 11 or 12-bit resolution).</li>
<li>Temperature conversion and retrieval.</li>
<li>Separation of conversion and temperature retrieval to allow for simultaneous conversion across multiple devices.</li>
</ul>
<h2>Parasitic Power Mode</h2>
<p>Consult the <a href="http://datasheets.maximintegrated.com/en/ds/DS18B20.pdf">datasheet</a> for more detailed information about Parasitic Power mode.</p>
<p>Parasitic power operation can be detected by <code><a class="el" href="ds18b20_8h.html#ad144c72353070a8b49a2f53ff118f18c" title="Check OneWire bus for presence of parasitic-powered devices. ">ds18b20_check_for_parasite_power()</a></code> followed by a call to <code>owb_use_parasitic_power()</code>, or simply set explicitly by a call to the latter.</p>
<p>This library has been tested on the ESP32 with two parasitic-power configurations, with two DS18B20 devices at 3.3V:</p>
<ol type="1">
<li>Disconnect power to each device's VDD pin, and connect that pin to GND for each device. Power is supplied to each device through the OWB data line.</li>
<li>Connect the OWB data line to VCC via a P-channel MOSFET (e.g. BS250) and current-limiting resistor (e.g. 270 Ohm). Ensure your code calls <code>owb_use_strong_pullup_gpio()</code> with the GPIO connected to the MOSFET Gate. The GPIO will go high during temperature conversion, turning on the MOSFET and providing power from VCC to each device through the OWB data line.</li>
</ol>
<p>If you set up configuration 1 and do not see CRC errors, but you get incorrect temperature readings around 80 - 85 degrees C, then it is likely that your DS18B20 devices are running out of power during the temperature conversion. In this case, consider reducing the value of the pull-up resistor. For example, I have had success obtaining correct conversions from two parasitic DS18B20 devices by replacing the 4k7 Ohm pull-up resistor with a 1 kOhm resistor.</p>
<p>Alternatively, consider using configuration 2.</p>
<p>Note that use of parasitic power mode disables the ability for devices on the bus to signal that an operation has completed. This means that DS18B20 devices in parasitic power mode are not able to communicate when they have completed a temperature conversion. In this mode, a delay for a pre-calculated duration occurs, and then the conversion result is read from the device(s). <em>If your ESP32 is not running on the correct clock rate, this duration may be too short!</em></p>
<h2>Documentation</h2>
<p>Automatically generated API documentation (doxygen) is available <a href="https://davidantliff.github.io/esp32-ds18b20/index.html">here</a>.</p>
<h2>Source Code</h2>
<p>The source is available from <a href="https://www.github.com/DavidAntliff/esp32-ds18b20">GitHub</a>.</p>
<h2>License</h2>
<p>The code in this project is licensed under the MIT license - see LICENSE for details.</p>
<h2>Links</h2>
<ul>
<li><a href="http://datasheets.maximintegrated.com/en/ds/DS18B20.pdf">DS18B20 Datasheet</a></li>
<li><a href="https://www.maximintegrated.com/en/app-notes/index.mvp/id/126">1-Wire Communication Through Software</a></li>
<li><a href="https://www.maximintegrated.com/en/app-notes/index.mvp/id/187">1-Wire Search Algorithm</a></li>
<li><a href="https://github.com/espressif/esp-idf">Espressif IoT Development Framework for ESP32</a></li>
</ul>
<h2>Acknowledgements</h2>
<p>Parts of this code are based on references provided to the public domain by Maxim Integrated.</p>
<p>"1-Wire" is a registered trademark of Maxim Integrated.</p>
<h2>Roadmap</h2>
<p>The following features are anticipated but not yet implemented:</p>
<ul>
<li>Concurrency support (multiple tasks accessing devices on the same bus).</li>
<li>Alarm support.</li>
<li>EEPROM support.</li>
<li>Parasitic power support. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
